http://sqlfiddle.com/#!9/de9c3a/1
http://sqlfiddle.com/#!17/7e403